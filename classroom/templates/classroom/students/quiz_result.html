{% extends 'base.html' %}
{% load quiz_extras %}

{% block content %}
{% include 'classroom/students/_header.html' with active='taken' %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'students:taken_quiz_list' %}">Quizzes</a></li>
      <li class="breadcrumb-item active" aria-current="page">{{quiz.name}}</li>
    </ol>
</nav>
<div class="progress mb-2" style="height: 22px;">
  <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: {{taken_quiz.percentage}}%" aria-valuenow="{{taken_quiz.percentage}}" aria-valuemin="0" aria-valuemax="100">{{taken_quiz.percentage}}%</div>
</div>
{{ quiz.subject.get_html_badge }}
<p class="lead">{{taken_quiz.score}} correct out of {{questions.count}}
  <br>Time Taken: {{taken_quiz.time_taken}}</p>

{% for question in questions %}
<div class="card">
  <div class="card-body">
    <h5 class="card-title">{{forloop.counter}}. {{question.text|safe}}</h5>
    <div class="table-responsive">
    <table class="table table-bordered table-sm">
      <thead><tr><th style="width: 70px;">Yours</th><th style="width: 70px;">Correct</th><th></th></tr></thead>
      <tbody>
        {% for opt in question.answers.all %}
        {% marked_answer user opt as opt_marked %}        
        <tr>
          <td class="{% if opt_marked == 'correct' %} bg-success{% elif opt_marked == 'wrong' %} bg-danger{% endif %}"></td>
          <td class="{% if opt.is_correct %} bg-success {% endif %}"></td>
          <td>{{opt.text}}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>
  </div>
</div>
<br>
{% endfor %}
{% endblock %}

{% block js %}
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
{% endblock %}